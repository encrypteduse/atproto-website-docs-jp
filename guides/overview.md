---
title: プロトコルの概要
summary: AT Protocolについて紹介します。
---

# AT Protocolの概要

**Authenticated Transfer Protocol**、通称**ATP**は、大規模な分散型ソーシャルアプリケーションのためのプロトコルです。本資料では、ATプロトコルの背景にある考え方を紹介します。

## 同一性

ユーザーは、ATプロトコルのドメイン名で識別されます。これらのドメインは、ユーザーのアカウントとそのデータを保護する暗号化URLにマッピングされます。

![Identities](/img/identities.jpg)

## データリポジトリ

ユーザーデータは、[署名付きデータリポジトリ](/guides/data-repos.md)で交換されます。これらのリポジトリは、投稿、コメント、いいね！、フォロー、メディアブロブなどを含むレコードの集合体です。

![Data repos](/img/data-repos.jpg)

## フェデレーション（連合）

ATPは、フェデレーテッド・ネットワーキング・モデルでリポジトリを同期します。フェデレーションは、ネットワークが便利に使え、確実に利用できるようにするために選ばれました。コマンドは、[HTTPS + XRPC](/specs/xrpc.md)を使用してサーバー間で送信されます。

![Federation](/img/federation.jpg)

## 相互運用

[Lexicon](/specs/lexicon.md)と呼ばれるグローバルなスキーマネットワークは、サーバー間で呼び出しの名前と動作を統一するために使用されています。サーバーは、ユーザーリポジトリを同期するためのコアな[ATP Lexicon](/lexicons/atproto-com.md) や、基本的なソーシャル動作を提供するための [Bsky Lexicon](/lexicons/bsky-app.md) など、機能セットをサポートする「レキシコン（辞書）」を実装します。

![Interop](/img/interop.jpg)

Webがドキュメントを交換するのに対し、ATプロトコルは回路図とセマンティック情報を交換し、異なる組織のソフトウェアが互いのデータを理解することを可能にします。これにより、ATPクライアントはサーバーに依存しないユーザーインターフェースを自由に作成できるようになり、コンテンツを閲覧する際にレンダリングコード（HTML/JS/CSS）をやり取りする必要がなくなります。

## スケールの実現

ATPでは、「スモールワールド」と「ビッグワールド」のネットワーキングを区別しています。*スモールワールド*ネットワーキングは個人間の活動を包含し、*ビッグワールド*ネットワーキングはユーザーの個人的な交流の外にある活動を集約します。

* **スモールワールド**: メンション、リプライ、DMなど、特定のユーザーを対象としたイベントの配信、フォローグラフに応じたデータセットの同期など。
* **ビッグワールド**: 大規模な指標（いいね、リポスト、フォロワー）、コンテンツの発見（アルゴリズム）、ユーザー検索など。

パーソナルデータサーバー（PDS）はスモールワールドのネットワークを担当し、インデックスサービスは別途ネットワークをクロールしてビッグワールドのネットワークを提供します。

![Small world, Big world](/img/small-big-world.jpg)

スモールワールドとビッグワールドの区別は、スケール感だけでなく、ユーザーの高い選択性を実現することを意図しています。

## アルゴリズム的な選択

ウェブ検索エンジンと同様に、ユーザーは自由にインデクサを選択することができます。各フィード、ディスカバリーセクション、検索インターフェースは、サードパーティーのサービスから提供されながら、PDSに統合されています。

![Algorithmic choice](/img/algorithmic-choice.jpg)

## アカウントのポータビリティ

パーソナルデータサーバー（PDS）は、全体がオフラインになったり、特定のユーザーに対するサービスを停止したりと、いつでも障害が発生する可能性があると想定しています。ATPの目標は、サーバーの関与なしに、ユーザーが自分のアカウントを新しいPDSに移行できるようにすることです。

ユーザーデータは[署名付きデータリポジトリ](/guides/data-repos.md)に保存され、[DIDs](/guides/identity.md)によって検証されます。DIDは、基本的にユーザー証明書のレジストリであり、TLS証明書システムに似ているところがあります。DIDは、安全で信頼性が高く、ユーザーのPDSから独立していることが期待されています。

![DID Documents](/img/did-doc.jpg)

各DIDドキュメントは、署名鍵と復元鍵の2つの公開鍵を公開します。

* **署名鍵**: DID Documentの変更とユーザーのデータリポジトリへの変更を主張します。
* **復元鍵**: 72時間以内であれば、署名鍵を上書きすることができます。

署名鍵はPDSがユーザーのデータを管理できるように預けますが、復元鍵はたとえば印刷された鍵などとしてユーザーが保存します。これにより、ユーザーは元のホストの手を借りずに、新しいPDSにアカウントを更新することが可能になります。


![Account recovery](/img/recovery.jpg)

ユーザーのデータのバックアップは、バックアップとしてクライアントに永続的に同期されます（利用可能なディスク容量に依存します）。PDSが予告なく消滅した場合、ユーザーはDIDドキュメントを更新し、バックアップをアップロードすることで、新しいプロバイダーに移行することができるはずです。

## 発言・リーチ・節制

ATPのモデルは、「スピーチ」と「リーチ」は2つの別々のレイヤーであるべきで、互いに協力し合うように構築されています。「スピーチ」レイヤーは中立的な立場を保ち、権威を分散させ、誰もが発言できるように設計されています。「リーチ」レイヤーはその上に位置し、柔軟性を備え、拡張できるように設計されています。

![Speech vs Reach](/img/speech-vs-reach.jpg)

ATPのベースレイヤー（パーソナルデータレポジトリとフェデレートネットワーキング）は、誰もが自由に参加できる言論のための共通の空間を作り出します。これは、誰でもウェブサイトを立ち上げることができるウェブに似ています。そして、インデックスサービスは、検索エンジンに例えられるように、ネットワークからコンテンツを集約することでリーチを可能にします。

## Specifications

5つの主要な仕様が@-protocolのv1を構成しています。これらのスペックは以下の通りです。

- [Authenticated Transfer Protocol](/specs/atp.md)
- [Cross-system RPC (XRPC)](/specs/xrpc.md)
- [Lexicon Schemas](/specs/lexicon.md)
- [NameSpaced IDs (NSIDs)](/specs/nsid.md)
- [DID:Placeholder (did:plc)](/specs/did-plc.md)

これらのスペックは、依存関係の3つのレイヤーに整理することができます。

![Spec diagram](/img/spec-diagram.jpg)


ここから先は、[ガイドと仕様書](/docs.md)にて読み進めることができます。
